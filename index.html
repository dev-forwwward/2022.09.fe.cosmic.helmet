<!DOCTYPE html>
<html lang="en">

<head>
	<title>helmet-cubemap</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<link type="text/css" rel="stylesheet" href="main.css">
</head>

<body>

	<div id="container"></div>

	<!-- Import maps polyfill -->
	<!-- Remove this when import maps will be widely supported -->
	<script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>
	<script type="importmap">
		{
			"imports": {
				"three": "https://unpkg.com/three/build/three.module.js",
				"three/addons/": "https://unpkg.com/browse/three@0.143.0/examples/jsm/"
			}
		}
	</script>

	<script type="module">

		import * as THREE from 'three';
		import Stats from 'https://unpkg.com/three@0.143.0/examples/jsm/libs/stats.module.js';
		import { OrbitControls } from 'https://unpkg.com/three@0.143.0/examples/jsm/controls/OrbitControls.js';
		import { OBJLoader } from 'https://unpkg.com/three@0.143.0/examples/jsm/loaders/OBJLoader.js';

		let container, stats;

		let camera, scene, renderer;

		let pointLight;

		init();
		animate();

		function init() {


			container = document.createElement('div');
			document.getElementById("container").appendChild(container);

			camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
			camera.position.x = 50;

			// create environment map
			var envMap = new THREE.CubeTextureLoader()
				.setPath('/textures/')
				.load(['nr-1.jpg', 'nr-2.jpg', 'nr-3.jpg', 'nr-4.jpg', 'nr-5.jpg', 'nr-6.jpg']);

			//scene
			scene = new THREE.Scene();

			//lights
			const ambient = new THREE.AmbientLight(0xffffff);
			scene.add(ambient);

			pointLight = new THREE.PointLight(0xffffff, 2);
			scene.add(pointLight);

			//materials
			const cubeMaterial1 = new THREE.MeshLambertMaterial({
				color: 0xffffff,
				envMap: envMap
			});

			//models
			const objLoader = new OBJLoader();

			objLoader.setPath('/models/obj/helmet/');
			objLoader.load('main-helmet-texture.obj', function (object) {

				const head = object.children[0];

				head.scale.multiplyScalar(20);
				head.position.x = 0;
				head.position.y = 0;
				head.position.z = 0;
				head.material = cubeMaterial1;

				scene.add(head);

			});

			//renderer
			renderer = new THREE.WebGLRenderer();
			renderer.setPixelRatio(window.devicePixelRatio);
			renderer.setSize(window.innerWidth, window.innerHeight);
			container.appendChild(renderer.domElement);

			//controls
			const controls = new OrbitControls(camera, renderer.domElement);
			controls.enableZoom = false;
			controls.enablePan = false;
			controls.minPolarAngle = Math.PI / 4;
			controls.maxPolarAngle = Math.PI / 1.5;

			//stats
			stats = new Stats();
			container.appendChild(stats.dom);

			window.addEventListener('resize', onWindowResize);

		}

		function onWindowResize() {

			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();

			renderer.setSize(window.innerWidth, window.innerHeight);

		}

		function animate() {

			requestAnimationFrame(animate);
			render();

		}

		function render() {

			renderer.render(scene, camera);
			stats.update();

		}
	</script>

</body>

</html>